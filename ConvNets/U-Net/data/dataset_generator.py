# -*- coding: utf-8 -*-
"""dataset_generator.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1aNSZTPoVDF27D72Zr-93SLfHjvAs2J1B
"""

import os
from torch.utils.data import Dataset
import numpy as np
from PIL import Image

class Cityscapes(Dataset):
  def __init__(self, path, transform = None):
    self.root_dir = path
    self.images = self.root_dir+'inputs/'
    self.labels = self.root_dir+'labels/'
    assert len(self.labels) == len(self.images)
    self.transform = transform
  
  def __len__(self):
    return len(self.labels)
  
  def __getitem__(self, index):
    image = Image.open(self.images + str(index+1) + '.jpg')
    label = Image.open(self.labels + str(index+1) + '.jpg')

    if self.transform is not None:
      image = self.transform(image)
      

    return image, label
